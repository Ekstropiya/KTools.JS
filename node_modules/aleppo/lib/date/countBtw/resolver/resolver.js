'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _timestamp = require('../../helper/generator/timestamp');

var _timestamp2 = _interopRequireDefault(_timestamp);

var _formatResolver = require('./formatResolver');

var _formatResolver2 = _interopRequireDefault(_formatResolver);

var _recognizer = require('../recognizer');

var _recognizer2 = _interopRequireDefault(_recognizer);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var resolver = function resolver(expectedfunc) {
  for (var _len = arguments.length, fromUntil = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    fromUntil[_key - 1] = arguments[_key];
  }

  var len = _recognizer2.default.length(fromUntil);
  var inputTyp = [len];
  var frmTl = [false, false];
  if (len === 2) {
    if (expectedfunc === 'format') {
      for (var i = 0; i < 2; i += 1) {
        inputTyp[i] = _recognizer2.default.type(fromUntil[i]);
        if (inputTyp[i] === 'format') {
          frmTl[i] = (0, _formatResolver2.default)(fromUntil[i]);
        }
      }
    } else {
      // user has provided both frm and tl.
      // statr processing.
      for (var _i = 0; _i < 2; _i += 1) {
        inputTyp[_i] = _recognizer2.default.type(fromUntil[_i]);
        if (inputTyp[_i] === 'format') {
          frmTl[_i] = (0, _formatResolver2.default)(fromUntil[_i]);
        } else if (inputTyp[_i] === 'num') {
          if (_i === 0) {
            if (expectedfunc === 'year') frmTl[0] = _timestamp2.default.beginning.yearKnown(fromUntil[_i]);else frmTl[0] = _timestamp2.default.beginning[expectedfunc](fromUntil[_i]);
          } else {
            frmTl[1] = _timestamp2.default.now[expectedfunc](fromUntil[_i]);
          }
        } else if (inputTyp[_i] === 'ts') {
          frmTl[_i] = fromUntil[_i];
        }
      }
    }
  } else if (len === 1) {
    // user has provided tl.

    // be default frm, index = 0 is beginning of the year
    frmTl[0] = _timestamp2.default.beginning.yearDefault();
    // if expectedfunc is format the request must be format.
    if (expectedfunc === 'format') {
      inputTyp[0] = _recognizer2.default.type.apply(_recognizer2.default, fromUntil);
      if (inputTyp[0] === 'format') {
        frmTl[1] = _formatResolver2.default.apply(undefined, fromUntil);
      }
    } else {
      // procrss tl. index =1
      inputTyp[0] = _recognizer2.default.type.apply(_recognizer2.default, fromUntil);
      if (inputTyp[0] === 'format') {
        frmTl[1] = _formatResolver2.default.apply(undefined, fromUntil);
      } else if (inputTyp[0] === 'num') {
        var _tsGen$now;

        frmTl[1] = (_tsGen$now = _timestamp2.default.now)[expectedfunc].apply(_tsGen$now, fromUntil);
      } else {
        // if (inputTyp[0] === 'ts')
        frmTl[1] = fromUntil[0];
      }
    }
  } else if (len === 0) {
    // no input was provided.
    // default ftom beginning to now.
    frmTl[0] = _timestamp2.default.beginning.yearDefault();
    frmTl[1] = _timestamp2.default.now.nw();
  }
  return frmTl;
};

exports.default = resolver;